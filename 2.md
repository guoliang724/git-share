## commit without stage

直接 commit -a -m ""

## removing files

rm filename

## removing files from staging area

git rm --cached -r filename or directory

## removing files from working dir and staging area

git rm filename

## renaming or removing from working dir and staging area

git mv filename

## show files in staging are

git ls-files

## short status

git status -s

## view statged and unstaged changes

git diff --staged

git restore --staged `filename` or .

## discard local changes

git restore `filename`  
git clean -fd

## set the vs code as the diff tool

git config --global diff.tool vscode
git config --global difftool.vscode.cmd "code --wait --diff $LOCAL $REMOTE"

## edit

git config --global -e

## viewing history

git log
git log --oneline
git log --oneline --reverse
git log --online -stat
git log --oneline -patch
git log --oneline --author=""
git log --oneline --before="2020-08-17"
git log --oneline --grep="GUI"
git log --oneline -- `filename`
git log --oneline --patch -- `filename`

## format the log output

git log --pretty=format:""

## Aliases

git config --global alias.lg "log --pretty=format:``"

## viewing a commit

git show `hash`
git show head~1  
git show head~1:.gitignore `备注：the content of one commit`
git ls-tree head~1

## viewing the changes across commits

git diff HEAD~2 HEAD
git diff HEAD~2 HEAD --name-status

## restoring a file to an earlier version

git restore --source=HEAD~1 `filename`
git checkout `hash` `filename`

## checking out a commit

## finding bugs using bisect

git bisect start
git bisect bad

## finding contributors using shortlog

git shortlog -n
git shortlog -n -s
git shortlog -n -s -e --before=""

## finding the author of line using blame

git blame `filename`
git blame -e `filename`
git blame -e -L 1,3 `filename`

## tagging

git tag

git tag v1.0 5 `hash`

git tag -d `tagname`

# working with branches

git branch `bugfix`
git switch branch `bugfix`
git branch -m bugfix `newbranname`
git branch -D `branchname`
git branch -C `branchname`

## comparing branches

git log master..`branchname`
git diff master..`branchname`
git diff `branchname`
git diff --name--status `branchname`

## stashing

git stash push -m "`stashname`"
git stash show stash{1}
git stash apply `number`
git stash drop `number`
git stash list
git stash clear

## merging

### fast-forward merge

  <!--fast-forward是线性合并。如果开分支后，master又有修改，合并后如果要返回，需要返回多步；
  ；three-way是开叉合并。如果开分支后，master又有修改，合并后可以追溯到岔开路径中的任意节点 -->

git merge `branchname`

### three-way merge

git merge --no-ff `branchname`
git forward --gloabl ff no

## viewing merged and unmerged branches

git branch --merged
git branch -d `branchname`
git branch --no-merged

## merging confilcts

## graphical merge tools

git config --global merge.tool p4merge
git config --global mergetool.p4merge.path "/Applications/p4merge.app/Contents/MacOS/p4merge"

## Aborting a merge

git merge --abort

## undoing a faulty merge

<!-- soft: affect last snapshot
     mixed: affect last snapshot and staging area
     hard: affect all
-->
<!--
using reset --hard: if you have pushed the change and you want to revert the repo, be aware that it may affect others in the repo history. An alternative option is:
using revert: you have to sepcify which one parent branch you want to back

-->

git reset --hard HEAD~1
git revert HEAD
git revert -m 1 HEAD

## squash merging

git merge --squash `branchname`
git branch -D `branchname`

<!-- after squashing, the log history is changing as well,
it will become a linear line-->

## rebasing

git rebase master
git rebase --continue
git rebase --skip
git rebase --abort

## cherry picking

git cherry-pick `hash`

## picking a file from another branch

git restore --source=`branchname` -- `filename`
git commit -am "`content`"

# collaboration

## cloning a repository

git clone `address`
git remote
git remote -v

## fetching

git fetch
git merge origin/master
git fetch origin `branchname`
git branch -vv <!--see the difference between local master and remote master-->

## pulling = fetch + merge

git pull <!--default:git will excute a three way merge-->
git pull -rebase <!--doing a rebase merge(linear)-->

## pushing

git push origin master

## storing credentials

git credential-osxkeychain

## sharing tags

git tag v1.0
git push origin v1.0
git push origin --delete v1.0
git tag -d v1.0

## sharing branches

git switch -C `branchname`
git branch -vv

git branch -r
git push -u origin `branchname`
git push -u -d origin `branchname`
git branch -d `branchname`

## collaboration workflow

A: doing some changes in branch1
git push origin branch1

B:
git fetch
git branch -r
git switch -C `branchname`(branch1) origin `branchname`(branch1)

then:
git switch master

git merge `branchname`
git push
then:(delete the branch)
git push -d origin `branchname`
git branch -d `branchname`

A:
git switch master
git pull
git branch -d `branchname`
git remote prune origin

## keep a forked repositroy up to date

git remote -v
git remote add `name` `url`
git remote rename `upstream` `base`
git remote rm `name`

pull from orginal git repo

# rewrite history

## the golden rule of rewriting history

do not rewrite a public history

## undoing commits

git reset --hard `hashname`

<!--
    soft: removes the commit only
    mixed: unstages files
    hard: discards local changes
-->

git revert HEAD~3..HEAD (not include HEAD~3)
git revert --no-commit HEAD~3..
git rever --continue

git revert -abort

## recovering lost commits

git relog
git reset --hard `hashname`

## amending the last commit

git commit --amend -m `msg`

## amending an earlier commit

git rebase -i `hash`
...doing changes...
git add .
git commit --amend
git rebase --continue

 <!--rebasing rewrite history, only using in having not pushed-->

## drop commit

wip: +terms.txt >> draft
update terms: package->update terms: - +

git rebase -i `parenthash`

## rewording commit msg

git rebase -i `hash`
replace pick to reword
